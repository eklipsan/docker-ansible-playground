# Проект среды Docker-Ansible

## Введение

Этот проект представляет собой среду на базе Docker, предназначенную для разработки и тестирования плейбуков Ansible. В ней имеется мастер-контейнер, оснащенный Ansible, SSH и другими необходимыми инструментами для оркестровки и автоматизации задач в нескольких рабочих контейнерах. Эта настройка особенно полезна для разработчиков, желающих протестировать свои сценарии Ansible в контролируемой, изолированной среде.

## Особенности

- **Изолированная среда разработки**: Использует Docker для создания изолированной среды, имитирующей производственные системы.
- **Ansible Ready**: Мастер-контейнер поставляется с предустановленной конфигурацией Ansible, что позволяет сразу же приступить к тестированию и разработке сценариев.
- **Простая конфигурация**: Включает файлы конфигурации Docker Compose и Ansible для простой настройки и развертывания.
- **SSH-доступ**: Настроен для доступа по SSH для упрощения взаимодействия с контейнерами.

## Предварительные условия

Прежде чем приступить к работе, убедитесь, что в вашей системе установлено следующее:
- Docker
- Docker Compose
- Ansible (для разработки плейбуков на хост-машине)

## Начало работы

### Настройка

1. **Сборка и запуск контейнеров**:
   Используйте Docker Compose для сборки и запуска контейнеров.
   ``bash
   docker-compose up --build
   ```
2. **Доступ к мастер-контейнеру**:
   Мастер-контейнер настроен для доступа по SSH. Используйте следующую команду для доступа к нему:
   ``bash
   docker exec -it master_container_name bash
   ```
3. **Запуск игровых книг Ansible**:
   Внутри мастер-контейнера вы можете запустить игровые книги Ansible для рабочих контейнеров, используя предоставленный инвентарь и конфигурации.

### Конфигурационные файлы

- `Dockerfile_master` и `Dockerfile_worker`: Dockerфайлы для сборки мастер- и рабочих контейнеров соответственно.
- `docker-compose.yaml`: Определяет и запускает многоконтейнерное Docker-приложение.
- `ansible_files/`: Содержит файлы конфигурации и инвентаризации Ansible для выполнения плейбуков.

## Конфигурация SSH

SSH настроен на авторизацию по логину и паролю root в контейнерах, что облегчает доступ и управление.

## Конфигурация Ansible

Мастер-контейнер настроен в Ansible и готов к запуску плейбуков для рабочих контейнеров. В файле инвентаризации `ansible_files/inventory.txt` перечислены рабочие контейнеры и их IP-адреса для Ansible.

## Конфигурация сети

Настроенная мостовая сеть соединяет контейнеры, при этом каждому контейнеру назначены статические IP-адреса для упрощения управления сетью и выполнения плейбуков.

## Переменные окружения

Для настройки используется несколько переменных окружения, включая, но не ограничиваясь, `MASTER_ANSIBLE_CONFIG`, `MASTER_DEBIAN_IP` и `WORKER_DEBIAN_IP`.

## Заключение

Этот проект среды Docker-Ansible упрощает процесс разработки и тестирования плейбуков Ansible. Предоставляя изолированную, легко настраиваемую среду, он позволяет разработчикам сосредоточиться на разработке плейбуков, не заботясь о базовой инфраструктуре.

## Ссылки

- SSH-доступ к контейнеру Docker: [SSH в контейнер Docker](https://vmblog.ru/ssh-vhod-v-docker-kontejner/)
- Шлюз по умолчанию в Linux: [Default Gateway on StackOverflow](https://stackoverflow.com/questions/1204629/how-do-i-get-the-default-gateway-in-linux-given-the-destination)


Переведено с помощью DeepL.com (бесплатная версия)